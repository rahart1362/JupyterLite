"use strict";(self.webpackChunk_anaconda_share_notebook=self.webpackChunk_anaconda_share_notebook||[]).push([[305,380],{5380:(e,o,t)=>{t.r(o),t.d(o,{ShareNotebookPlugin:()=>k});var n=t(7717),a=t(6805),r=t(1464),c=t(7097);async function l(e,o="Copied to clipboard",t="Failed to copy to clipboard"){try{await navigator.clipboard.writeText(e),c.L.success(o,{autoClose:5e3})}catch(e){c.L.error(t,{autoClose:5e3}),console.error(t,e)}}var s=t(9369),i=t(6029),d=t.n(i);class b{showPreviewShare;shareButtonUseV2;constructor(e,o){this.showPreviewShare=e,this.shareButtonUseV2=o}createNew(e,o){const t=new r.ToolbarButton({className:"share-notebook-button",label:"Share",icon:new a.LabIcon({name:"ui-components:share-notebook",svgstr:'<svg width="24" height="24" viewBox="0 0 24 24" fill="none"\nxmlns="http://www.w3.org/2000/svg">\n<g clip-path="url(#clip0_289_5006)">\n    <path d="M18 16.08C17.24 16.08 16.56 16.38 16.04 16.85L8.91 12.7C8.96 12.47 9 12.24 9 12C9 11.76 8.96 11.53 8.91 11.3L15.96 7.19C16.5 7.69 17.21 8 18 8C19.66 8 21 6.66 21 5C21 3.34 19.66 2 18 2C16.34 2 15 3.34 15 5C15 5.24 15.04 5.47 15.09 5.7L8.04 9.81C7.5 9.31 6.79 9 6 9C4.34 9 3 10.34 3 12C3 13.66 4.34 15 6 15C6.79 15 7.5 14.69 8.04 14.19L15.16 18.35C15.11 18.56 15.08 18.78 15.08 19C15.08 20.61 16.39 21.92 18 21.92C19.61 21.92 20.92 20.61 20.92 19C20.92 17.39 19.61 16.08 18 16.08Z" fill="#323232"/>\n</g>\n<defs>\n    <clipPath id="clip0_289_5006">\n        <rect width="24" height="24" fill="white"/>\n    </clipPath>\n</defs>\n</svg>'}),onClick:()=>{h(e,this.showPreviewShare,this.shareButtonUseV2)},tooltip:"Share notebook"});return e.toolbar.insertAfter("spacer","shareNotebookButton",t),new n.DisposableDelegate((()=>{t.dispose()}))}}async function h(e,o,t){if(!e)return void console.error("no notebook widget found");const n=e.context,a=n.contentsModel?.name,c=e.model;if(c?.dirty&&!await async function(e){return(await(0,r.showDialog)({title:"Publish unsaved notebook?",body:"The notebook has unsaved changes. Do you want to save changes before sharing?",host:document.body,hasClose:!0,buttons:[r.Dialog.cancelButton({label:"Cancel"}),r.Dialog.okButton({label:"Share Without Saving"}),r.Dialog.okButton({label:"Save and Share",caption:"Save changes before sharing",actions:["save"]})]}).then((o=>(o.button.actions.includes("save")&&(console.log("saving notebook"),e?.context.save()),o)))).button.accept}(e))return;const i=(await r.InputDialog.getText({title:"Filename of shared notebook",text:a})).value;if(!i)return;const b=c?.toJSON();try{const e=await async function(e,o,t){const n={nb_json:o,upload_filename:e},a=t?"aext_share_notebook_server/share_notebook_v2":"aext_share_notebook_server/share_notebook",r=await s.backend.backendFetch(a,{},{method:"POST",body:JSON.stringify(n)}).then((e=>s.backend.handleProxyResponse(e)));return{notebook_url:r.notebook_url,project_id:r.project_id,project_name:r.project_name,preview_url:r.preview_url,overview_url:r.overview_url,cloud_base_url:r.cloud_base_url}}(i,b,t);!function(e,o,t,n,a){const c="https://static.anaconda.cloud/content/a22d04e8445b700f28937ab3231b8cded505d0395c63b7a269696722196d5415",s=`${n}/nbserve/launch_notebook?nb_url=${encodeURIComponent(e)}`,i=`<a target="_blank" href=${s}><img src="${c}"/></a>`,b=d().createElement(d().Fragment,null,d().createElement("div",{className:"notebook-shared-dialog"},!a&&d().createElement("div",{className:"notebook-shared-link"},d().createElement("h4",null,"Share Notebook Link"),d().createElement("div",{className:"notebook-shared-link-copy"},d().createElement("input",{type:"text",id:"notebook_link",value:s}),d().createElement("a",{className:"notebook-shared-link-copy-button",onClick:()=>l(s,"Link to notebook copied to clipboard","An error occurred when copying the notebook link"),title:"Copy notebook link to clipboard"},d().createElement("div",{className:"notebook-shared-link-copy-icon"}))),d().createElement("button",{onClick:()=>l(`${s}`,"Link to notebook copied to clipboard","An error occurred when copying the notebook link"),className:"notebook-shared-copy-button"},d().createElement("div",{className:"notebook-shared-link-icon"}),"Copy Link")),a&&d().createElement("div",{className:"notebook-shared-link"},d().createElement("h4",{className:"notebook-shared-subheader"},"Preview Link"),d().createElement("p",null,"This will allow the recipient to preview, open, and/or download."),d().createElement("div",{className:"notebook-shared-link-copy"},d().createElement("input",{type:"text",id:"overview_link",value:o}),d().createElement("a",{className:"notebook-shared-link-copy-button",onClick:()=>l(o,"Link to notebook preview copied to clipboard","An error occurred when copying the notebook preview link"),title:"Copy notebook preview link to clipboard"},d().createElement("div",{className:"notebook-shared-link-copy-icon"}))),d().createElement("button",{onClick:()=>l(`${o}`,"Link to notebook copied to clipboard","An error occurred when copying the notebook link"),className:"notebook-shared-copy-button"},d().createElement("div",{className:"notebook-shared-link-icon"}),"Copy Link")),d().createElement("div",{className:"notebook-shared-badge"},d().createElement("h4",{className:"notebook-shared-subheader"},"Notebook Badge"),d().createElement("div",{className:"notebook-shared-badge-copy"},d().createElement("input",{type:"text",id:"badgeHTML",value:i}),d().createElement("a",{className:"notebook-shared-badge-copy-button",onClick:()=>l(`${i}`,"Badge HTML copied to clipboard","An error occurred when copying the badge HTML"),title:"Copy badge HTML to clipboard"},d().createElement("div",{className:"notebook-shared-badge-copy-icon"}))),d().createElement("p",null,"Badge Preview"),d().createElement("a",{target:"_blank",href:s},d().createElement("img",{src:c})),d().createElement("button",{onClick:()=>l(`${i}`,"Badge HTML copied to clipboard","An error occurred when copying the badge HTML"),className:"notebook-shared-copy-button"},d().createElement("div",{className:"notebook-shared-code-icon"}),"Copy Embed Code")))),h=document.createElement("div");h.classList.add("notebook-shared-modal"),document.body.appendChild(h),(0,r.showDialog)({title:`Share '${t}' Project`,body:b,host:h,hasClose:!0,buttons:[r.Dialog.okButton({label:"Done"})]})}(e.notebook_url,e.overview_url,e.project_name,e.cloud_base_url,o)}catch(e){return console.error(e),(0,r.showErrorMessage)("Error sharing notebook",e)}}class k{async activate(e,o){const t=await o.corePlugin.ready();if(!t.featureFlag.getBool("monorepo-share-notebooks",!1))return;console.log("[Monorepo] Enabling the share-notebook plugin");const n=t.featureFlag.getBool("sharing-show-preview",!1),a=t.featureFlag.getBool("share-notebook-use-projects-v2",!1);e.commands.addCommand("share-notebook:to-projects",{label:"Share Notebook",caption:"Share Notebook",execute:()=>{h(o.notebookTracker.currentWidget,n,a)}}),e.docRegistry.addWidgetExtension("Notebook",new b(n,a))}}}}]);